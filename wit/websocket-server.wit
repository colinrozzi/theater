package ntwk:theater;

interface websocket-server {
    record websocket-message {
        message-type: string,
        data: option<list<u8>>,
        text: option<string>,
    }

    record websocket-response {
        messages: list<websocket-message>,
    }

    // Called when a new WebSocket connection is established
    handle-connection: func(state: list<u8>) -> tuple<list<u8>, websocket-response>;

    // Called for each message received on the WebSocket
    handle-message: func(message: websocket-message, state: list<u8>) -> tuple<list<u8>, websocket-response>;
}