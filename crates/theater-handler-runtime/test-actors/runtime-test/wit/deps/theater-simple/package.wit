package theater:simple;

interface actor {
    init: func(state: option<list<u8>>, params: tuple<string>) -> result<tuple<option<list<u8>>>, string>;
}

interface types {
    type actor-id = string;
    type channel-id = string;

    record channel-accept {
        accepted: bool,
        message: option<list<u8>>,
    }

    record event {
        event-type: string,
        parent: option<u64>,
        data: list<u8>,
    }

    record meta-event {
        hash: u64,
        event: event,
    }

    record chain {
        events: list<meta-event>,
    }

    record chain-event {
        hash: list<u8>,
        parent-hash: option<list<u8>>,
        event-type: string,
        data: list<u8>,
        timestamp: u64,
        description: option<string>,
    }

    enum wit-error-type {
        operation-timeout,
        channel-closed,
        shutting-down,
        function-not-found,
        type-mismatch,
        internal,
        serialization-error,
        update-component-error,
        paused,
    }

    record wit-actor-error {
        error-type: wit-error-type,
        data: option<list<u8>>,
    }
}

interface runtime {
    use types.{chain, actor-id};

    log: func(msg: string);
    get-chain: func() -> chain;
    shutdown: func(data: option<list<u8>>) -> result<_, string>;
}
